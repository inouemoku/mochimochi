(function(e){function t(t){for(var o,r,c=t[0],s=t[1],l=t[2],f=0,u=[];f<c.length;f++)r=c[f],Object.prototype.hasOwnProperty.call(i,r)&&i[r]&&u.push(i[r][0]),i[r]=0;for(o in s)Object.prototype.hasOwnProperty.call(s,o)&&(e[o]=s[o]);d&&d(t);while(u.length)u.shift()();return a.push.apply(a,l||[]),n()}function n(){for(var e,t=0;t<a.length;t++){for(var n=a[t],o=!0,c=1;c<n.length;c++){var s=n[c];0!==i[s]&&(o=!1)}o&&(a.splice(t--,1),e=r(r.s=n[0]))}return e}var o={},i={app:0},a=[];function r(t){if(o[t])return o[t].exports;var n=o[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,r),n.l=!0,n.exports}r.m=e,r.c=o,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)r.d(n,o,function(t){return e[t]}.bind(null,o));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="";var c=window["webpackJsonp"]=window["webpackJsonp"]||[],s=c.push.bind(c);c.push=t,c=c.slice();for(var l=0;l<c.length;l++)t(c[l]);var d=s;a.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("56d7")},"56d7":function(e,t,n){"use strict";n.r(t);n("e260"),n("e6cf"),n("cca6"),n("a79d");var o=n("2b0e"),i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"app"}},[n("div",{staticClass:"container-fluid"},[n("h3",{staticClass:"my-3"},[e._v("MochiMochi - ココフォリアログ整形ツール")]),e._m(0),n("div",{staticClass:"row mt-3"},[n("div",{staticClass:"col-md-12"},[n("ccfolia-formatter")],1)])])])},a=[function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("small",[e._v(" 自分用に作ったログ整形ツールです。ココフォリアのログファイルを読み込ませて整形！ボタンを押すとダウンロードできます。"),n("br"),e._v(" おまけでダイス結果も見られます。 ")])}],r=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("el-form",{ref:"ccfoliaLog",staticClass:"mb-5",attrs:{model:e.ccfoliaLog}},[n("el-form-item",{attrs:{prop:"system"}},[n("el-select",{model:{value:e.ccfoliaLog.system,callback:function(t){e.$set(e.ccfoliaLog,"system",t)},expression:"ccfoliaLog.system"}},e._l(e.systems,(function(e){return n("el-option",{key:e.key,attrs:{label:e.name,value:e.key}})})),1)],1),n("el-form-item",{attrs:{prop:"file"}},[n("el-upload",{attrs:{drag:"",action:"","auto-upload":!1,"on-change":e.handleChangeFile}},[n("i",{staticClass:"el-icon-upload"}),n("div",{staticClass:"el-upload__text"},[e._v("Drop file here or "),n("em",[e._v("click to upload")])])])],1),n("div",{directives:[{name:"show",rawName:"v-show",value:e.ccfoliaLog.rows.length>0,expression:"ccfoliaLog.rows.length > 0"}]},[n("el-card",{staticClass:"mb-3",attrs:{shadow:"never"}},[n("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[n("span",[e._v("ダイス結果 "),n("el-popover",{attrs:{trigger:"hover",content:"ダイス結果だけまとめて見られます。"}},[n("el-button",{attrs:{slot:"reference",icon:"el-icon-question",type:"text"},slot:"reference"})],1)],1)]),n("el-radio-group",{attrs:{size:"mini"},model:{value:e.selectedDiceType,callback:function(t){e.selectedDiceType=t},expression:"selectedDiceType"}},e._l(e.systems.find((function(t){return t.key==e.ccfoliaLog.system})).diceTypes,(function(t){return n("el-radio-button",{key:t.key,attrs:{label:t.key}},[e._v(e._s(t.name))])})),1),n("el-checkbox-group",{model:{value:e.selectedDiceTabs,callback:function(t){e.selectedDiceTabs=t},expression:"selectedDiceTabs"}},[n("el-checkbox",{attrs:{label:"メイン"}}),n("el-checkbox",{attrs:{label:"情報"}}),n("el-checkbox",{attrs:{label:"雑談"}}),e._l(e.ccfoliaLog.tabs,(function(e,t){return n("el-checkbox",{key:t,attrs:{label:e.name}})}))],2),e._l(e.diceRows,(function(t,o){return n("div",{key:o},[n("div",{style:"color:"+t.color},[e._v(" ["+e._s(t.tab_name)+"] "+e._s(t.name)+"： "),n("span",{domProps:{innerHTML:e._s(t.body)}})])])}))],2),n("el-card",{staticClass:"mb-3",attrs:{shadow:"never"}},[n("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[n("span",[e._v("ヘッダー設定 "),n("el-popover",{attrs:{trigger:"hover",content:"ヘッダー色とタイトルの設定ができます。色は左と真ん中が背景色、右が文字色です。"}},[n("el-button",{attrs:{slot:"reference",icon:"el-icon-question",type:"text"},slot:"reference"})],1)],1)]),n("el-color-picker",{attrs:{predefine:e.predefineColors},model:{value:e.ccfoliaLog.header_color1,callback:function(t){e.$set(e.ccfoliaLog,"header_color1",t)},expression:"ccfoliaLog.header_color1"}}),n("el-color-picker",{attrs:{predefine:e.predefineColors},model:{value:e.ccfoliaLog.header_color2,callback:function(t){e.$set(e.ccfoliaLog,"header_color2",t)},expression:"ccfoliaLog.header_color2"}}),n("el-color-picker",{attrs:{predefine:e.predefineColors},model:{value:e.ccfoliaLog.link_color,callback:function(t){e.$set(e.ccfoliaLog,"link_color",t)},expression:"ccfoliaLog.link_color"}}),n("el-input",{staticClass:"mb-2",model:{value:e.ccfoliaLog.title,callback:function(t){e.$set(e.ccfoliaLog,"title",t)},expression:"ccfoliaLog.title"}}),n("div",{staticClass:"mb-3",style:"background:linear-gradient("+e.ccfoliaLog.header_color1+","+e.ccfoliaLog.header_color2+");color:"+e.ccfoliaLog.link_color},[n("div",{staticClass:"p-2"},[e._v(e._s(e.ccfoliaLog.title))]),n("div",{staticClass:"p-2"},e._l(e.dividerRows,(function(t){return n("span",{key:t.name},[e._v(e._s(t.name)+" ")])})),0)])],1),n("el-card",{directives:[{name:"show",rawName:"v-show",value:e.ccfoliaLog.tabs.length>0,expression:"ccfoliaLog.tabs.length > 0"}],staticClass:"mb-3",attrs:{shadow:"never"}},[n("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[n("span",[e._v("タブ色設定 "),n("el-popover",{attrs:{trigger:"hover",content:"雑談、情報以外のタブの色の設定ができます。左側がラインの色、右側が背景色です。"}},[n("el-button",{attrs:{slot:"reference",icon:"el-icon-question",type:"text"},slot:"reference"})],1)],1)]),e._l(e.ccfoliaLog.tabs,(function(t){return n("div",{key:t.name},[n("el-color-picker",{attrs:{predefine:e.predefineColors},model:{value:t.line_color,callback:function(n){e.$set(t,"line_color",n)},expression:"tab.line_color"}}),n("el-color-picker",{attrs:{predefine:e.predefineColors},model:{value:t.background_color,callback:function(n){e.$set(t,"background_color",n)},expression:"tab.background_color"}}),n("div",{staticClass:"mb-3",style:"font-size:13px;background-color:"+t.background_color+";border-left:solid 2px "+t.line_color+";"},[n("div",{staticClass:"p-2"},[e._v(e._s(t.name))])])],1)}))],2),n("el-card",{staticClass:"mb-4",attrs:{shadow:"never","body-style":{height:"500px","overflow-y":"scroll"}}},[n("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[n("span",[e._v("ログ全文 "),n("el-popover",{attrs:{trigger:"hover",content:"+ボタンを押すとログに区切りを追加することができます。ヘッダーにもリンクが追加されます。"}},[n("el-button",{attrs:{slot:"reference",icon:"el-icon-question",type:"text"},slot:"reference"})],1)],1)]),e._l(e.ccfoliaLog.rows,(function(t,o){return n("div",{key:o,staticClass:"my-1"},[t.is_divider?e._e():n("div",{style:"color:"+t.color},[n("el-button",{attrs:{size:"mini"},on:{click:function(t){return e.addRow(o)}}},[e._v("+")]),e._v(" ["+e._s(t.tab_name)+"] "+e._s(t.name)+"： "),n("span",{domProps:{innerHTML:e._s(t.body)}})],1),t.is_divider?n("div",[n("el-row",{attrs:{gutter:5}},[n("el-col",{attrs:{span:1}},[n("el-button",{attrs:{size:"mini"},on:{click:function(t){return e.addRow(o)}}},[e._v("+")])],1),n("el-col",{attrs:{span:2}},[n("el-input",{attrs:{size:"mini",placeholder:"リンク名"},model:{value:t.name,callback:function(n){e.$set(t,"name",n)},expression:"row.name"}})],1),n("el-col",{attrs:{span:10}},[n("el-input",{attrs:{size:"mini",placeholder:"表示名"},model:{value:t.body,callback:function(n){e.$set(t,"body",n)},expression:"row.body"}})],1),n("el-col",{attrs:{span:1}},[n("el-button",{attrs:{size:"mini",icon:"el-icon-delete"},on:{click:function(t){return e.removeRow(o)}}})],1)],1)],1):e._e()])}))],2)],1),n("el-button",{staticClass:"px-5",attrs:{type:"primary",disabled:e.ccfoliaLog.rows.length<=0},on:{click:e.postCcfoliaLog}},[e._v("整形！")])],1),n("el-divider"),n("small",[n("div",[e._v("最終更新: 2021-02-23 "),n("el-button",{attrs:{type:"text",size:"small"},on:{click:function(t){e.drawer=!0}}},[e._v("履歴")])],1),e._m(0)]),n("el-drawer",{attrs:{title:"履歴",visible:e.drawer},on:{"update:visible":function(t){e.drawer=t}}},[n("ul",{staticStyle:{"font-size":"0.9em"}},[n("li",[e._v("2021-02-23 公開")])])])],1)},c=[function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"mb-4"},[e._v("Twitter: "),n("a",{attrs:{href:"https://twitter.com/inouemoku",target:"_blank"}},[e._v("@inouemoku")])])}],s=n("2909"),l=(n("a434"),n("5319"),n("ac1f"),n("b0c0"),n("2b3d"),n("d3b7"),n("3ca3"),n("ddb0"),n("d81d"),n("fb6a"),n("466d"),n("6062"),n("99af"),n("13d5"),n("7db0"),n("4d63"),n("25f0"),n("a15b"),n("4de4"),n("caad"),n("2532"),n("d4ec")),d=n("bee2"),f=(n("c740"),function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;Object(l["a"])(this,e),this._key=this.paramFromObject(t,"key"),this._color=this.paramFromObject(t,"color"),this._tab_name=this.paramFromObject(t,"tab_name"),this._name=this.paramFromObject(t,"name"),this._body=this.paramFromObject(t,"body"),this._is_divider=this.paramFromObject(t,"is_divider"),this._dice_type=this.paramFromObject(t,"dice_type")}return Object(d["a"])(e,[{key:"paramFromObject",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return null==e||null==e[t]?n:e[t]}},{key:"format",value:function(e){if(this.is_divider)return'\n    <h2 id="key'.concat(this.key,'" class="day">').concat(this.body,'</h2><hr class="day-line">\n');var t=this.dice_type?this.dice_type.class:"",n=this.body.replace(/(.*)\nCthulhu : (.*)/,'$1<br>\n<span class="dice '.concat(t,'">Cthulhu :$2\n</span>'));return'\n      <div class="'.concat(this.class_name(e),'" style="color:').concat(this.color,';">\n        <span class="name-field"><span class="name"><span>').concat(this.name,'</span> :</span></span>\n        <span class="text">').concat(n,"</span>\n      </div>\n")}},{key:"class_name",value:function(e){var t=this;return"メイン"==this.tab_name||null==this.tab_name||""==this.tab_name?"":"雑談"==this.tab_name?"other":"情報"==this.tab_name?"info":(console.log(e),"secret tab".concat(e.findIndex((function(e){return e.name==t.tab_name}))))}},{key:"key",get:function(){return this._key},set:function(e){this._key=e}},{key:"color",get:function(){return this._color},set:function(e){this._color=e}},{key:"tab_name",get:function(){return this._tab_name},set:function(e){this._tab_name=e}},{key:"name",get:function(){return this._name},set:function(e){this._name=e}},{key:"body",get:function(){return this._body},set:function(e){this._body=e}},{key:"is_divider",get:function(){return this._is_divider},set:function(e){this._is_divider=e}},{key:"dice_type",get:function(){return this._dice_type},set:function(e){this._dice_type=e}}],[{key:"fromObject",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return new e(t)}}]),e}()),u=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;Object(l["a"])(this,e),this._file=this.paramFromObject(t,"file"),this._system=this.paramFromObject(t,"system","coc6"),this._header_color1=this.paramFromObject(t,"header_color1","#000"),this._header_color2=this.paramFromObject(t,"header_color2","#2E9BB1"),this._link_color=this.paramFromObject(t,"link_color","#fff"),this._title=this.paramFromObject(t,"title","【CoC】タイトル"),this._tabs=this.paramFromObject(t,"tabs",[]),this._doc="",this._rows=t?t["rows"].map((function(e){return f.fromObject(e)})):[]}return Object(d["a"])(e,[{key:"paramFromObject",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return null==e||null==e[t]?n:e[t]}},{key:"doc",get:function(){return this._doc},set:function(e){this._doc=e}},{key:"file",get:function(){return this._file},set:function(e){this._file=e}},{key:"system",get:function(){return this._system},set:function(e){this._system=e}},{key:"header_color1",get:function(){return this._header_color1},set:function(e){this._header_color1=e}},{key:"header_color2",get:function(){return this._header_color2},set:function(e){this._header_color2=e}},{key:"link_color",get:function(){return this._link_color},set:function(e){this._link_color=e}},{key:"title",get:function(){return this._title},set:function(e){this._title=e}},{key:"tabs",get:function(){return this._tabs},set:function(e){this._tabs=e}},{key:"rows",get:function(){return this._rows},set:function(e){this._rows=e}},{key:"format",value:function(){var e=this,t=this.rows.filter((function(e){return e.is_divider})),n=t.map((function(e,t){return'      <a href="#key'.concat(t,'">').concat(e.name,"</a>")})).join("\n"),o="";return this.tabs&&(o=this.tabs.reduce((function(e,t,n){return e+="\n  .tab".concat(n," {\n    background-color: ").concat(t.background_color,";\n    border-left:solid 2px ").concat(t.line_color,";\n  }\n"),e}),"")),'\n<!DOCTYPE html>\n<html lang="ja">\n  <head>\n    <meta charset="UTF-8" />\n    <meta name="viewport" content="width=device-width, initial-scale=1.0" />\n    <meta http-equiv="X-UA-Compatible" content="ie=edge" />\n    <title>'.concat(this.title,'</title>\n  </head>\n  <header id="header">\n    <h1>').concat(this.title,'</h1>\n    <div class="menu">\n').concat(n,'\n    </div>\n  </header>\n  <body>\n    <div class="main">\n').concat(this.rows.map((function(t){return t.format(e.tabs)})).join("\n"),'\n    </div>\n  </body>\n</html>\n<style type="text/css">\n  * {\n    margin: 0px;\n    padding: 0px;\n    font-family: sans-serif;\n  }\n  #header {\n    background: linear-gradient(').concat(this.header_color1,",").concat(this.header_color2,");\n    position: fixed;\n    width: 100%;\n    padding:10px;\n    opacity: 0.8;\n  }\n  #header a {\n    color: ").concat(this.link_color,";\n    text-decoration: none;\n    font-size: 14px;\n  }\n  #header a:hover{\n    text-decoration: underline;\n  }\n  h1 {\n    font-size: 18px;\n    color:#fff;\n    font-weight:normal\n  }\n  h2 {\n    font-size: 16px;\n    text-align: center;\n  }\n  .menu {\n    padding-left: 10px;\n  }\n  /* ダイスロール結果 */\n  .dice {\n    font-weight: bold;\n    color: #555;\n  }\n  .dice.success {\n    color: #2196f3;\n  }\n  .dice.failed {\n    color: #f50057;\n  }\n  .main {\n    padding: 10px 1em 100px;\n    padding-bottom: 100px;\n    font-size: 14px;\n  }\n  .main div {\n    padding-top: 5px;\n    padding-bottom: 5px;\n  }\n  /* 情報タブ */\n  .info {\n    background-color: #fafafa;\n    border-left:solid 2px #bbb;    \n  }\n  /* 雑談タブ */\n  .other {\n    font-size: 12px;\n    margin-left: 50px;\n    padding-left: 10px;\n    padding-right: 10px;\n    background-color: #f7f7f7;\n    border-left:solid 1px #aaa;\n  }\n  /* 秘話 */\n  .secret {\n    font-size: 13px;\n    margin-left:50px;\n    padding-left:10px;\n    padding-right: 10px;\n  }\n").concat(o,"\n  .name-field {\n    display: inline-block;\n    font-weight: bold;\n    padding-right:5px;\n    vertical-align: top;\n  }\n  .text {\n    display: block;\n    word-break: break-word;\n  }\n  .day-line {\n    height: 1px;\n    background-color: #999999;\n    border: none;\n    margin: 10px 20px;\n  }\n  .day {\n    padding-top: 100px;\n  }\n  @media (min-width: 947px) {\n    /* 横幅が947px以上の場合に適用するスタイル */\n    .name-field {\n      text-align: right;\n      width: 120px;\n    }\n    .text {\n      display: inline-block;\n      width: 800px;\n      vertical-align: top;\n    }\n    .secret {\n      margin-left: 100px;\n    }\n  }\n</style>\n")}}],[{key:"fromObject",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return new e(t)}}]),e}(),p={name:"CcfoliaFormatter",components:{},data:function(){return{ccfoliaLog:u.fromObject(),predefineColors:["#ff4500","#ff8c00","#ffd700","#90ee90","#00ced1","#1e90ff","#c71585"],systems:[{key:"coc6",name:"クトゥルフ神話TRPG",diceText:"Cthulhu",diceTypes:[{key:"critical",name:"決定的成功",class:"success"},{key:"famble",name:"致命的失敗",class:"failed"},{key:"special",name:"スペシャル",class:"success"},{key:"success",name:"成功",class:"success"},{key:"partial",name:"部分的成功",class:"success"},{key:"failed",name:"失敗",class:"failed"}]}],selectedDiceType:"",selectedDiceTabs:["メイン"],drawer:!1}},props:{},methods:{addRow:function(e){this.ccfoliaLog.rows.splice(e,0,f.fromObject({is_divider:!0,name:"",body:""}))},removeRow:function(e){this.ccfoliaLog.rows.splice(e,1)},postCcfoliaLog:function(){var e=this.ccfoliaLog.file.name.replace(/^(.*).html$/,"$1_整形.html");this.downloadBlob(this.ccfoliaLog.format(),e,"text/html")},handleChangeFile:function(e){this.ccfoliaLog.file=e,this.analyzeHtml()},downloadBlob:function(e,t,n){if(window.navigator.msSaveOrOpenBlob)window.navigator.msSaveOrOpenBlob(e,t);else{var o=URL.createObjectURL(new Blob([e],{type:n})),i=document.createElement("a");i.href=o,i.setAttribute("download",t),document.body.appendChild(i),i.click(),URL.revokeObjectURL(o),i.parentNode.removeChild(i)}},analyzeHtml:function(){var e=this,t=new FileReader,n=this;t.onload=function(e){console.log(e);var o=new DOMParser,i=o.parseFromString(t.result,"text/html"),a=i.getElementsByTagName("parsererror");if(a.length>0)return n.$message({type:"error",message:"ファイルの解析に失敗しました"}),void console.log(a);var r=i.getElementsByTagName("p");n.ccfoliaLog.rows=Array.prototype.slice.call(r).map((function(e){var t={color:e.outerHTML.match(/<p style="color:(.*);">/)[1],tab_name:e.children[0].innerText.replace(/^ \[(.*)\]/,"$1"),name:e.children[1].innerText,body:e.children[2].innerHTML,dice_type:n.diceType(e.children[2].innerHTML)};return f.fromObject(t)}));var c=Object(s["a"])(new Set(n.ccfoliaLog.rows.map((function(e){return e.tab_name})))),l=f.fromObject({is_divider:!0,name:"1",body:"1日目"});n.ccfoliaLog.rows=[l].concat(n.ccfoliaLog.rows);var d=c.reduce((function(e,t){return"メイン"!=t&&"雑談"!=t&&"情報"!=t&&e.push({name:t,line_color:"#aaa",background_color:"#f7f7f7"}),e}),[]);n.ccfoliaLog.tabs=d},t.readAsText(this.ccfoliaLog.file.raw),this.selectedDiceType=this.systems.find((function(t){return t.key==e.ccfoliaLog.system})).diceTypes[0].key},diceType:function(e){var t=this,n=this.systems.find((function(e){return e.key==t.ccfoliaLog.system})),o=new RegExp(".*".concat(n.diceText," :.*＞ (").concat(n.diceTypes.map((function(e){return e.name})).join("|"),")")),i=e.match(o);return i?n.diceTypes.find((function(e){return e.name==i[1]})):null}},computed:{dividerRows:function(){return this.ccfoliaLog.rows.filter((function(e){return e.is_divider}))},diceRows:function(){var e=this;return this.ccfoliaLog.rows.filter((function(t){return t.dice_type&&t.dice_type.key==e.selectedDiceType&&e.selectedDiceTabs.includes(t.tab_name)}))}}},h=p,m=n("2877"),b=Object(m["a"])(h,r,c,!1,null,null,null),_=b.exports,v={name:"App",components:{CcfoliaFormatter:_}},y=v,g=Object(m["a"])(y,i,a,!1,null,null,null),k=g.exports,x=n("5c96"),w=n.n(x),L=n("c3ff"),O=n.n(L),j=n("4897"),C=n.n(j);n("0fae"),n("e05f"),n("f9e3"),n("2dd8");C.a.use(O.a),o["default"].use(w.a),o["default"].config.productionTip=!0,new o["default"]({render:function(e){return e(k)}}).$mount("#app")}});
//# sourceMappingURL=app.b0a6020b.js.map
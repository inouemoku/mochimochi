(function(e){function t(t){for(var a,o,l=t[0],r=t[1],c=t[2],m=0,h=[];m<l.length;m++)o=l[m],Object.prototype.hasOwnProperty.call(n,o)&&n[o]&&h.push(n[o][0]),n[o]=0;for(a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a]);d&&d(t);while(h.length)h.shift()();return i.push.apply(i,c||[]),s()}function s(){for(var e,t=0;t<i.length;t++){for(var s=i[t],a=!0,l=1;l<s.length;l++){var r=s[l];0!==n[r]&&(a=!1)}a&&(i.splice(t--,1),e=o(o.s=s[0]))}return e}var a={},n={app:0},i=[];function o(t){if(a[t])return a[t].exports;var s=a[t]={i:t,l:!1,exports:{}};return e[t].call(s.exports,s,s.exports,o),s.l=!0,s.exports}o.m=e,o.c=a,o.d=function(e,t,s){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:s})},o.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var s=Object.create(null);if(o.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)o.d(s,a,function(t){return e[t]}.bind(null,a));return s},o.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="";var l=window["webpackJsonp"]=window["webpackJsonp"]||[],r=l.push.bind(l);l.push=t,l=l.slice();for(var c=0;c<l.length;c++)t(l[c]);var d=r;i.push([0,"chunk-vendors"]),s()})({0:function(e,t,s){e.exports=s("56d7")},"0211":function(e,t,s){"use strict";s("061c")},"061c":function(e,t,s){},"56d7":function(e,t,s){"use strict";s.r(t);s("e260"),s("e6cf"),s("cca6"),s("a79d");var a=s("2b0e"),n=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{attrs:{id:"app"}},[s("div",{staticClass:"container-fluid"},[s("h3",{staticClass:"my-3"},[e._v("MochiMochi - ココフォリアログ整形ツール")]),e._m(0),s("div",{staticClass:"row mt-3"},[s("div",{staticClass:"col-md-12"},[s("ccfolia-formatter")],1)])])])},i=[function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("small",[e._v(" 自分用に作ったログ整形ツールです。ココフォリアのログファイルを読み込ませて「整形！」ボタンを押すとダウンロードできます。"),s("br"),e._v(" 「整形しないでダウンロード」ボタンを押すと元の形式のままダウンロードできます。選択したタブとシークレットダイスだけ反映されます。"),s("br"),e._v(" システムに「その他」以外を選択した場合は、ダイス結果も見られます。 ")])}],o=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("el-form",{ref:"ccfoliaLog",staticClass:"mb-5",attrs:{model:e.ccfoliaLog}},[s("el-form-item",{attrs:{prop:"system"}},[s("el-select",{model:{value:e.ccfoliaLog.system,callback:function(t){e.$set(e.ccfoliaLog,"system",t)},expression:"ccfoliaLog.system"}},e._l(e.systems,(function(e){return s("el-option",{key:e.key,attrs:{label:e.name,value:e.key}})})),1)],1),s("el-form-item",{attrs:{prop:"file"}},[s("el-upload",{attrs:{drag:"",action:"","auto-upload":!1,"on-change":e.handleChangeFile}},[s("i",{staticClass:"el-icon-upload"}),s("div",{staticClass:"el-upload__text"},[e._v("Drop file here or "),s("em",[e._v("click to upload")])])])],1),s("div",{directives:[{name:"show",rawName:"v-show",value:e.ccfoliaLog.rows.length>0,expression:"ccfoliaLog.rows.length > 0"}]},["other"!=e.ccfoliaLog.system?s("el-card",{staticClass:"mb-3",attrs:{shadow:"never"}},[s("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[s("span",[e._v("ダイス結果 "),s("el-tooltip",{attrs:{effect:"dark",placement:"top-start",content:"ダイス結果だけまとめて見られます。"}},[s("el-button",{attrs:{icon:"el-icon-question",type:"text"}})],1)],1)]),s("el-radio-group",{attrs:{size:"mini"},model:{value:e.selectedDiceResult,callback:function(t){e.selectedDiceResult=t},expression:"selectedDiceResult"}},e._l(e.system.diceResults,(function(t){return s("el-radio-button",{key:t.key,attrs:{label:t.key}},[e._v(e._s(t.name))])})),1),s("el-checkbox-group",{model:{value:e.selectedDiceTabs,callback:function(t){e.selectedDiceTabs=t},expression:"selectedDiceTabs"}},[s("el-checkbox",{attrs:{label:"メイン"}}),s("el-checkbox",{attrs:{label:"情報"}}),s("el-checkbox",{attrs:{label:"雑談"}}),e._l(e.ccfoliaLog.tabs,(function(e,t){return s("el-checkbox",{key:t,attrs:{label:e.name}})}))],2),s("el-checkbox-group",{model:{value:e.selectedNameTabs,callback:function(t){e.selectedNameTabs=t},expression:"selectedNameTabs"}},e._l(e.names,(function(e,t){return s("el-checkbox",{key:t,attrs:{label:e}})})),1),s("small",[e._v("計")]),e._v(" "+e._s(e.diceRows.length)+" "),s("small",[e._v("回")]),e._l(e.diceRows,(function(t,a){return s("div",{key:a},[s("div",{style:"color:"+t.color},[e._v(" ["+e._s(t.tab_name)+"] "+e._s(t.name)+"： "),s("span",{domProps:{innerHTML:e._s(t.body)}})])])}))],2):e._e(),s("el-card",{staticClass:"mb-3",attrs:{shadow:"never"}},[s("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[s("span",[e._v("ヘッダー設定 "),s("el-tooltip",{attrs:{effect:"dark",placement:"top-start"}},[s("div",{attrs:{slot:"content"},slot:"content"},[e._v("ヘッダー色とタイトルの設定ができます。"),s("br"),e._v("色は左と真ん中が背景色、右が文字色です。")]),s("el-button",{attrs:{icon:"el-icon-question",type:"text"}})],1)],1)]),s("el-color-picker",{attrs:{predefine:e.predefineColors},model:{value:e.ccfoliaLog.header_color1,callback:function(t){e.$set(e.ccfoliaLog,"header_color1",t)},expression:"ccfoliaLog.header_color1"}}),s("el-color-picker",{attrs:{predefine:e.predefineColors},model:{value:e.ccfoliaLog.header_color2,callback:function(t){e.$set(e.ccfoliaLog,"header_color2",t)},expression:"ccfoliaLog.header_color2"}}),s("el-color-picker",{attrs:{predefine:e.predefineColors},model:{value:e.ccfoliaLog.link_color,callback:function(t){e.$set(e.ccfoliaLog,"link_color",t)},expression:"ccfoliaLog.link_color"}}),s("el-input",{staticClass:"mb-2",model:{value:e.ccfoliaLog.title,callback:function(t){e.$set(e.ccfoliaLog,"title",t)},expression:"ccfoliaLog.title"}}),s("div",{staticClass:"mb-3",style:"background:linear-gradient("+e.ccfoliaLog.header_color1+","+e.ccfoliaLog.header_color2+");color:"+e.ccfoliaLog.link_color},[s("div",{staticClass:"p-2"},[e._v(e._s(e.ccfoliaLog.title))]),s("div",{staticClass:"p-2"},e._l(e.dividerRows,(function(t){return s("span",{key:t.name},[e._v(e._s(t.name)+" ")])})),0)])],1),s("el-card",{staticClass:"mb-3",attrs:{shadow:"never"}},[s("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[s("span",[e._v("タブ設定 "),s("el-tooltip",{attrs:{effect:"dark",placement:"top-start"}},[s("div",{attrs:{slot:"content"},slot:"content"},[e._v("出力するタブを設定できます。"),s("br"),e._v("雑談、情報以外のタブの色の設定ができます。"),s("br"),e._v("左側がラインの色、右側が背景色です。")]),s("el-button",{attrs:{icon:"el-icon-question",type:"text"}})],1)],1)]),s("small",[e._v("チェックの入っているタブが出力されます。")]),s("el-checkbox-group",{model:{value:e.selectedOutputTabs,callback:function(t){e.selectedOutputTabs=t},expression:"selectedOutputTabs"}},[s("el-checkbox",{attrs:{label:"メイン"}}),s("el-checkbox",{attrs:{label:"情報"}}),s("el-checkbox",{attrs:{label:"雑談"}}),e._l(e.ccfoliaLog.tabs,(function(e,t){return s("el-checkbox",{key:t,attrs:{label:e.name}})}))],2),s("el-checkbox",{attrs:{label:"シークレットダイスを隠す",border:"",size:"small"},model:{value:e.isHideSecretDice,callback:function(t){e.isHideSecretDice=t},expression:"isHideSecretDice"}}),e.ccfoliaLog.tabs.length>0?s("el-divider"):e._e(),e.ccfoliaLog.tabs.length>0?s("div",{staticClass:"mb-2"},[e._v("色設定")]):e._e(),e._l(e.ccfoliaLog.tabs,(function(t){return s("div",{directives:[{name:"show",rawName:"v-show",value:e.selectedOutputTabs.includes(t.name),expression:"selectedOutputTabs.includes(tab.name)"}],key:t.name},[s("el-color-picker",{attrs:{predefine:e.predefineColors},model:{value:t.line_color,callback:function(s){e.$set(t,"line_color",s)},expression:"tab.line_color"}}),s("el-color-picker",{attrs:{predefine:e.predefineColors},model:{value:t.background_color,callback:function(s){e.$set(t,"background_color",s)},expression:"tab.background_color"}}),s("div",{staticClass:"mb-3",style:"font-size:13px;background-color:"+t.background_color+";border-left:solid 2px "+t.line_color+";"},[s("div",{staticClass:"p-2"},[e._v(e._s(t.name))])])],1)}))],2),s("el-card",{staticClass:"mb-4",attrs:{shadow:"never","body-style":{height:"95vh","overflow-y":"scroll"}}},[s("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[s("span",[e._v("ログ全文 "),s("el-tooltip",{attrs:{effect:"dark",placement:"top-start"}},[s("el-button",{attrs:{icon:"el-icon-question",type:"text"}}),s("div",{attrs:{slot:"content"},slot:"content"},[e._v("+ボタンを押すとログに区切りを追加することができます。ヘッダーにもリンクが追加されます。"),s("br"),e._v("行ごと掴んで順序を入れ替えることができます。"),s("br"),e._v("磁石ボタンを押すと2回目に押した磁石ボタンまでの間にある同じタブ名の行をまとめることができます。")])],1)],1)]),s("draggable",{attrs:{options:{animation:200,handle:".handle"},list:e.ccfoliaLog.rows}},e._l(e.ccfoliaLog.rows,(function(t,a){return s("div",{key:a,staticClass:"my-1"},[t.is_divider?e._e():s("div",{directives:[{name:"show",rawName:"v-show",value:e.selectedOutputTabs.includes(t.tab_name),expression:"selectedOutputTabs.includes(row.tab_name)"}],staticClass:"draggable handle",style:"color:"+t.color+";background-color:"+e.backgroundColor(t.tab_name)},[s("el-button",{attrs:{size:"mini"},on:{click:function(t){return e.addRow(a)}}},[e._v("+")]),s("el-button",{attrs:{size:"mini",icon:"el-icon-attract",type:e.attractButtonType(a),disabled:e.attractFrom&&a<e.attractFrom},on:{click:function(t){return e.attract(a)}}}),e._v(" ["+e._s(t.tab_name)+"] "+e._s(t.name)+"： "),s("span",{domProps:{innerHTML:e._s(t.body)}}),s("el-tag",{directives:[{name:"show",rawName:"v-show",value:t.is_secret,expression:"row.is_secret"}],attrs:{size:"mini",type:"warning"}},[e._v("シークレットダイス")])],1),t.is_divider?s("div",[s("el-row",{attrs:{gutter:5}},[s("el-col",{attrs:{span:1}},[s("el-button",{attrs:{size:"mini"},on:{click:function(t){return e.addRow(a)}}},[e._v("+")])],1),s("el-col",{attrs:{span:2}},[s("el-input",{attrs:{size:"mini",placeholder:"リンク名"},model:{value:t.name,callback:function(s){e.$set(t,"name",s)},expression:"row.name"}})],1),s("el-col",{attrs:{span:10}},[s("el-input",{attrs:{size:"mini",placeholder:"表示名"},model:{value:t.body,callback:function(s){e.$set(t,"body",s)},expression:"row.body"}})],1),s("el-col",{attrs:{span:1}},[s("el-button",{attrs:{size:"mini",icon:"el-icon-delete"},on:{click:function(t){return e.removeRow(a)}}})],1),s("el-col",{staticClass:"draggable handle text-white",attrs:{span:10}},[e._v(":")])],1)],1):e._e()])})),0)],1)],1),s("el-tooltip",{attrs:{placement:"top-start"}},[s("div",{attrs:{slot:"content"},slot:"content"},[e._v("ヘッダーやタブなど全ての設定が反映されます。")]),s("el-button",{staticClass:"px-5",attrs:{type:"primary",disabled:e.ccfoliaLog.rows.length<=0},on:{click:e.postCcfoliaLog}},[e._v("整形！")])],1),s("el-tooltip",{attrs:{placement:"top-start"}},[s("div",{attrs:{slot:"content"},slot:"content"},[e._v("タブとシークレットダイスの設定だけ反映されます。")]),s("el-button",{staticClass:"px-5",attrs:{type:"warning",disabled:e.ccfoliaLog.rows.length<=0},on:{click:e.postOriginalCcfoliaLog}},[e._v("整形しないでダウンロード")])],1)],1),s("el-divider"),s("small",[s("div",[e._v("最終更新: 2023-09-11 "),s("el-button",{attrs:{type:"text",size:"small"},on:{click:function(t){e.drawer=!0}}},[e._v("履歴")])],1),e._m(0)]),s("el-drawer",{attrs:{title:"履歴",visible:e.drawer},on:{"update:visible":function(t){e.drawer=t}}},[s("ul",{staticStyle:{"font-size":"0.9em"}},[s("li",[e._v("2023-09-11 タブごとに行をまとめる時に他のタブも巻き込めるように変更")]),s("li",[e._v("2023-06-19 整形したログを再度読み込めるように変更")]),s("li",[e._v("2023-03-26 タブごとに行をまとめる機能を追加")]),s("li",[e._v("2022-10-26 整形しないでダウンロードする機能を追加")]),s("li",[e._v("2022-09-06 本文の順序入れ替え時にフォーム部分が反応しないように修正")]),s("li",[e._v("2022-05-30 シークレットダイスの判定を修正")]),s("li",[e._v("2022-05-20 シークレットダイスの判定を修正")]),s("li",[e._v("2022-05-07 インセイン、シノビガミに対応")]),s("li",[e._v("2022-04-26 シークレットダイスの結果を隠せるように変更")]),s("li",[e._v("2022-04-22 出力するタブを選択できるように変更")]),s("li",[e._v("2022-02-06 タブ色設定の初期色を変更")]),s("li",[e._v("2021-09-14 ヘッダーのタイトル色が変更されないのを修正")]),s("li",[e._v("2021-06-27 背景色が編集パネルに反映されるように変更")]),s("li",[e._v("2021-06-06 ダイス結果を名前で絞り込めるように変更")]),s("li",[e._v("2021-03-29 エモクロアTRPGに対応")]),s("li",[e._v("2021-03-15 リンクが効かない不具合の修正")]),s("li",[e._v("2021-03-13 本文の順序を入れ替える機能を追加")]),s("li",[e._v("2021-02-27 一行のダイス結果表記に対応")]),s("li",[e._v("2021-02-23 公開")])])])],1)},l=[function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"mb-4"},[e._v("Twitter: "),s("a",{attrs:{href:"https://twitter.com/inouemoku",target:"_blank"}},[e._v("@inouemoku")])])}],r=(s("2b3d"),s("b76a")),c=s.n(r);class d{constructor(e=null){this._key=this.paramFromObject(e,"key"),this._color=this.paramFromObject(e,"color"),this._tab_name=this.paramFromObject(e,"tab_name"),this._name=this.paramFromObject(e,"name"),this._body=this.paramFromObject(e,"body"),this._is_divider=this.paramFromObject(e,"is_divider"),this._dice_type=this.paramFromObject(e,"dice_type"),this._is_oneline=this.paramFromObject(e,"is_oneline"),this._is_secret=this.paramFromObject(e,"is_secret")}paramFromObject(e,t,s=null){return null==e||null==e[t]?s:e[t]}format(e,t,s,a){if(this.is_divider)return`    <h2 id="key${this.key}" class="day">${this.body}</h2><hr class="day-line">\n`;if(!s.includes(this.tab_name))return"";const n=this.formatBySystem(e,a);return`      <div class="${this.class_name(t)}" style="color:${this.color};" tab-name="${this.htmlSpecialChars(this.tab_name)}">\n        <span class="name-field"><span class="name"><span>${this.name}</span> :</span></span>\n        <span class="text">${n}</span>\n      </div>\n`}htmlSpecialChars(e){var t=document.createTextNode(e),s=document.createElement("p");return s.appendChild(t),s.innerHTML}notFormat(e,t){if(!e.includes(this.tab_name))return"";const s=t&&this.is_secret?"シークレットダイス":this.body;return`    <p style="color:${this.color};">\n      <span> [${this.tab_name}]</span>\n      <span>${this.name}</span> :\n      <span>${s}</span>\n    </p>\n    \n`}formatBySystem(e,t){if(t&&this.is_secret)return"シークレットダイス";const s=this.dice_type?this.dice_type.class:"";if("coc6"==e)return this.is_oneline?this.body.replace(/(.*)\((.*)\)(.*)＞ (.*)/,`$1<br>\n<span class="dice ${s}">($2)$3＞ $4</span>`):this.body.replace(/(.*)\nCthulhu : (.*)/,`$1<br>\n<span class="dice ${s}">Cthulhu :$2\n</span>`);if("emoklore"==e||"insane"==e||"shinobigami"==e){const e=/(.*)\((.*)\) ＞ \((.*)\) ＞ (.*)/;return e.test(this.body)?this.body.replace(e,`$1<br>\n<span class="dice ${s}">($2) ＞ ($3) ＞ $4</span>`):this.body.replace(/(.*)\((.*)\)(.*)＞ (.*)/,`$1<br>\n<span class="dice ${s}">($2)$3＞ $4</span>`)}return this.body}class_name(e){return"メイン"==this.tab_name||null==this.tab_name||""==this.tab_name?"":"雑談"==this.tab_name?"other":"情報"==this.tab_name?"info":(console.log(e),"secret tab"+e.findIndex(e=>e.name==this.tab_name))}static fromObject(e=null){return new d(e)}get key(){return this._key}set key(e){this._key=e}get color(){return this._color}set color(e){this._color=e}get tab_name(){return this._tab_name}set tab_name(e){this._tab_name=e}get name(){return this._name}set name(e){this._name=e}get body(){return this._body}set body(e){this._body=e}get is_divider(){return this._is_divider}set is_divider(e){this._is_divider=e}get dice_type(){return this._dice_type}set dice_type(e){this._dice_type=e}get is_oneline(){return this._is_oneline}set is_oneline(e){this._is_oneline=e}get is_secret(){return this._is_secret}set is_secret(e){this._is_secret=e}}class m{constructor(e=null){this._file=this.paramFromObject(e,"file"),this._system=this.paramFromObject(e,"system","coc6"),this._header_color1=this.paramFromObject(e,"header_color1","#000"),this._header_color2=this.paramFromObject(e,"header_color2","#2E9BB1"),this._link_color=this.paramFromObject(e,"link_color","#fff"),this._title=this.paramFromObject(e,"title","【CoC】タイトル"),this._tabs=this.paramFromObject(e,"tabs",[]),this._doc="",this._rows=e?e["rows"].map(e=>d.fromObject(e)):[]}paramFromObject(e,t,s=null){return null==e||null==e[t]?s:e[t]}static fromObject(e=null){return new m(e)}get doc(){return this._doc}set doc(e){this._doc=e}get file(){return this._file}set file(e){this._file=e}get system(){return this._system}set system(e){this._system=e}get header_color1(){return this._header_color1}set header_color1(e){this._header_color1=e}get header_color2(){return this._header_color2}set header_color2(e){this._header_color2=e}get link_color(){return this._link_color}set link_color(e){this._link_color=e}get title(){return this._title}set title(e){this._title=e}get tabs(){return this._tabs}set tabs(e){this._tabs=e}get rows(){return this._rows}set rows(e){this._rows=e}format(e,t){const s=this.rows.filter(e=>e.is_divider),a=s.map(e=>`      <a href="#key${e.key}">${e.name}</a>`).join("\n");let n="";return this.tabs&&(n=this.tabs.reduce((e,t,s)=>(e+=`\n  .tab${s} {\n    background-color: ${t.background_color};\n    border-left:solid 2px ${t.line_color};\n  }\n`,e),"")),`\n<!DOCTYPE html>\n<html lang="ja">\n  <head>\n    <meta charset="UTF-8" />\n    <meta name="viewport" content="width=device-width, initial-scale=1.0" />\n    <meta http-equiv="X-UA-Compatible" content="ie=edge" />\n    <title>${this.title}</title>\n  </head>\n  <header id="header">\n    <h1>${this.title}</h1>\n    <div class="menu">\n${a}\n    </div>\n  </header>\n  <body>\n    <div class="main">\n${this.rows.map(s=>s.format(this.system,this.tabs,e,t)).join("\n")}\n    </div>\n  </body>\n</html>\n<style type="text/css">\n  * {\n    margin: 0px;\n    padding: 0px;\n    font-family: sans-serif;\n  }\n  #header {\n    background: linear-gradient(${this.header_color1},${this.header_color2});\n    position: fixed;\n    width: 100%;\n    padding:10px;\n    opacity: 0.8;\n  }\n  #header a {\n    color: ${this.link_color};\n    text-decoration: none;\n    font-size: 14px;\n  }\n  #header a:hover{\n    text-decoration: underline;\n  }\n  h1 {\n    font-size: 18px;\n    color:${this.link_color};\n    font-weight:normal\n  }\n  h2 {\n    font-size: 16px;\n    text-align: center;\n  }\n  .menu {\n    padding-left: 10px;\n  }\n  /* ダイスロール結果 */\n  .dice {\n    font-weight: bold;\n    color: #555;\n  }\n  .dice.success {\n    color: #2196f3;\n  }\n  .dice.failed {\n    color: #f50057;\n  }\n  .main {\n    padding: 10px 1em 100px;\n    padding-bottom: 100px;\n    font-size: 14px;\n  }\n  .main div {\n    padding-top: 5px;\n    padding-bottom: 5px;\n  }\n  /* 情報タブ */\n  .info {\n    background-color: #fafafa;\n    border-left:solid 2px #bbb;    \n  }\n  /* 雑談タブ */\n  .other {\n    font-size: 12px;\n    margin-left: 50px;\n    padding-left: 10px;\n    padding-right: 10px;\n    background-color: #f7f7f7;\n    border-left:solid 1px #aaa;\n  }\n  /* 秘話 */\n  .secret {\n    font-size: 13px;\n    margin-left:50px;\n    padding-left:10px;\n    padding-right: 10px;\n  }\n${n}\n  .name-field {\n    display: inline-block;\n    font-weight: bold;\n    padding-right:5px;\n    vertical-align: top;\n  }\n  .text {\n    display: block;\n    word-break: break-word;\n  }\n  .day-line {\n    height: 1px;\n    background-color: #999999;\n    border: none;\n    margin: 10px 20px;\n  }\n  .day {\n    padding-top: 100px;\n  }\n  @media (min-width: 947px) {\n    /* 横幅が947px以上の場合に適用するスタイル */\n    .name-field {\n      text-align: right;\n      width: 120px;\n    }\n    .text {\n      display: inline-block;\n      width: 800px;\n      vertical-align: top;\n    }\n    .secret {\n      margin-left: 100px;\n    }\n  }\n</style>\n`}notFormat(e,t){return`<!DOCTYPE html>\n<html lang="ja">\n  <head>\n    <meta charset="UTF-8" />\n    <meta name="viewport" content="width=device-width, initial-scale=1.0" />\n    <meta http-equiv="X-UA-Compatible" content="ie=edge" />\n    <title>ccfolia - logs</title>\n  </head>\n  <body>\n    \n${this.rows.map(s=>s.notFormat(e,t)).join("")}  </body>\n</html>`}}var h={name:"CcfoliaFormatter",components:{draggable:c.a},data(){return{ccfoliaLog:m.fromObject(),predefineColors:["#ff4500","#ff8c00","#ffd700","#90ee90","#00ced1","#1e90ff","#c71585"],systems:[{key:"coc6",prefix:"【CoC】",name:"クトゥルフ神話TRPG",diceText:"Cthulhu",diceResults:[{key:"critical",name:"決定的成功"},{key:"famble",name:"致命的失敗"},{key:"special",name:"スペシャル"},{key:"success",name:"成功"},{key:"failed",name:"失敗"}],diceTypes:[{resultKey:"critical",name:"決定的成功",class:"success"},{resultKey:"famble",name:"致命的失敗",class:"failed"},{resultKey:"special",name:"スペシャル",class:"success"},{resultKey:"success",name:"成功",class:"success"},{resultKey:"success",name:"部分的成功",class:"success"},{resultKey:"failed",name:"失敗",class:"failed"},{resultKey:"failed",name:"故障",class:"failed"}]},{key:"emoklore",prefix:"【エモクロア】",name:"エモクロアTRPG",diceText:"Emoklore",diceResults:[{key:"catastrophe",name:"カタストロフ"},{key:"miracle",name:"ミラクル"},{key:"triple",name:"トリプル"},{key:"double",name:"ダブル"},{key:"success",name:"シングル"},{key:"failed",name:"失敗"},{key:"famble",name:"ファンブル"}],diceTypes:[{resultKey:"catastrophe",name:"カタストロフ!",class:"success"},{resultKey:"miracle",name:"ミラクル!",class:"success"},{resultKey:"triple",name:"トリプル!",class:"success"},{resultKey:"double",name:"ダブル!",class:"success"},{resultKey:"success",name:"成功!",class:"success"},{resultKey:"failed",name:"失敗!",class:"failed"},{resultKey:"famble",name:"ファンブル!",class:"failed"}]},{key:"insane",prefix:"【インセイン】",name:"インセイン",diceText:"Insane",diceResults:[{key:"special",name:"スペシャル"},{key:"success",name:"成功"},{key:"failed",name:"失敗"},{key:"famble",name:"ファンブル"}],diceTypes:[{resultKey:"famble",name:"ファンブル",class:"failed"},{resultKey:"special",name:"スペシャル",class:"success"},{resultKey:"success",name:"成功",class:"success"},{resultKey:"failed",name:"失敗",class:"failed"}]},{key:"shinobigami",prefix:"【シノビガミ】",name:"シノビガミ",diceText:"ShinobiGami",diceResults:[{key:"special",name:"スペシャル"},{key:"success",name:"成功"},{key:"failed",name:"失敗"},{key:"famble",name:"ファンブル"}],diceTypes:[{resultKey:"famble",name:"ファンブル",class:"failed"},{resultKey:"special",name:"スペシャル",class:"success"},{resultKey:"success",name:"成功",class:"success"},{resultKey:"failed",name:"失敗",class:"failed"}]},{key:"other",prefix:"",name:"その他",diceText:"",diceResults:[],diceTypes:[]}],system:{},selectedDiceResult:"",selectedDiceTabs:["メイン"],selectedNameTabs:[],selectedOutputTabs:[],names:[],drawer:!1,isHideSecretDice:!1,attractFrom:null,dogs:[]}},props:{},methods:{addRow(e){this.ccfoliaLog.rows.splice(e,0,d.fromObject({is_divider:!0,name:"",body:"",key:this.dividerRows.length}))},removeRow(e){this.ccfoliaLog.rows.splice(e,1)},postCcfoliaLog(){const e=this.ccfoliaLog.file.name.replace(/^(.*).html$/,"$1_整形.html");this.downloadBlob(this.ccfoliaLog.format(this.selectedOutputTabs,this.isHideSecretDice),e,"text/html")},postOriginalCcfoliaLog(){const e=this.ccfoliaLog.file.name;this.downloadBlob(this.ccfoliaLog.notFormat(this.selectedOutputTabs,this.isHideSecretDice),e,"text/html")},handleChangeFile(e){this.ccfoliaLog.file=e,this.system=this.systems.find(e=>e.key==this.ccfoliaLog.system);const t=this.ccfoliaLog.file.name.replace(/^(.*).html$/,"$1").replace(/^(.*)\[all\]$/,"$1");this.ccfoliaLog.title=`${this.system.prefix}${t}`,this.analyzeHtml()},downloadBlob(e,t,s){if(window.navigator.msSaveOrOpenBlob)window.navigator.msSaveOrOpenBlob(e,t);else{const a=URL.createObjectURL(new Blob([e],{type:s})),n=document.createElement("a");n.href=a,n.setAttribute("download",t),document.body.appendChild(n),n.click(),URL.revokeObjectURL(a),n.parentNode.removeChild(n)}},analyzeHtml(){const e=new FileReader,t=this;e.onload=function(){const s=new DOMParser,a=s.parseFromString(e.result,"text/html"),n=a.getElementsByTagName("parsererror");if(n.length>0)return t.$message({type:"error",message:"ファイルの解析に失敗しました"}),void console.log(n);const i=a.getElementsByClassName("main");i.length>0?t.analyzeHtmlMochiMochi(a):t.analyzeHtmlCcfolia(a),console.log("onload end")},e.readAsText(this.ccfoliaLog.file.raw),this.system.diceTypes[0]&&(this.selectedDiceResult=this.system.diceTypes[0].resultKey)},analyzeHtmlCcfolia(e){const t=Array.from(e.getElementsByTagName("p"));this.ccfoliaLog.rows=t.map(e=>{const{isOneline:t,diceType:s,isSecret:a}=this.diceType(e.children[2].innerHTML),n={color:e.outerHTML.match(/<p style="color:(.*);">/)[1],tab_name:e.children[0].innerText.replace(/^ \[(.*)\]/,"$1"),name:e.children[1].innerText,body:e.children[2].innerHTML,dice_type:s,is_oneline:t,is_secret:a};return d.fromObject(n)});const{names:s,selectedNameTabs:a}=this.ccfoliaLog.rows.filter(e=>null!=e.dice_type).reduce(({names:e,selectedNameTabs:t},s)=>(e.includes(s.name)||(e.push(s.name),t.push(s.name)),{names:e,selectedNameTabs:t}),{names:[],selectedNameTabs:[]});this.names=s,this.selectedNameTabs=a;const n=[...new Set(this.ccfoliaLog.rows.map(e=>e.tab_name))],i=d.fromObject({key:0,is_divider:!0,name:"1",body:"1日目"}),o=n.reduce((e,t)=>("メイン"!=t&&"雑談"!=t&&"情報"!=t&&e.push(this.tabColors(t)),e),[]);this.selectedOutputTabs=n,this.ccfoliaLog.rows=[i].concat(this.ccfoliaLog.rows),this.ccfoliaLog.tabs=o},analyzeHtmlMochiMochi(e){const t=Array.from(e.getElementById("header").children);this.ccfoliaLog.title=t[0].innerText;const s=Array.from(t[1].children).map(e=>({key:e.hash.slice(1),name:e.innerText}));console.log(e.getElementsByClassName("main")[0].children);const a=Array.from(e.getElementsByClassName("main")[0].children),n=e.getElementsByTagName("style")[0].innerText,i=this.parseCssToObject(n),o=i.find(e=>"#header"==e.key).contents.background.match(/linear-gradient\((#.*),(#.*)\)/);this.ccfoliaLog.header_color1=o[1],this.ccfoliaLog.header_color2=o[2];const l=function(e){return"#"+e.match(/\d+/g).map((function(e){return("0"+parseInt(e).toString(16)).slice(-2)})).join("")};this.ccfoliaLog.rows=a.map(e=>{if("day-line"==e.className)return;if("day"==e.className){const t=e.id.slice(3),a=d.fromObject({key:t,is_divider:!0,name:s.find(e=>e.key.slice(3)==t).name,body:e.innerText});return a}const t=this.diceTypeMochi(e.children[1]),a=null==t?e.children[1].innerHTML:this.htmlSpecialChars(""+e.children[1].innerText),{isOneline:n,diceType:i,isSecret:o}=this.diceType(a),r={color:l(e.style.color),tab_name:this.tabNameMochi(e),name:e.children[0].children[0].innerText.slice(0,-2),body:a,dice_type:i,is_oneline:n,is_secret:o};return d.fromObject(r)}).filter(e=>e);const{names:r,selectedNameTabs:c}=this.ccfoliaLog.rows.filter(e=>null!=e.dice_type).reduce(({names:e,selectedNameTabs:t},s)=>(e.includes(s.name)||(e.push(s.name),t.push(s.name)),{names:e,selectedNameTabs:t}),{names:[],selectedNameTabs:[]});this.names=r,this.selectedNameTabs=c;const m=[...new Set(this.ccfoliaLog.rows.map(e=>e.tab_name))].filter(e=>e);var h=0;const u=m.reduce((e,t)=>{if("メイン"!=t&&"雑談"!=t&&"情報"!=t){const s=i.find(e=>e.key==".tab"+h).contents,a=s["border-left"].match(/.*(#.*)/)[1],n=s["background-color"];h+=1,e.push(this.tabColors(t,a,n))}return e},[]);this.selectedOutputTabs=m,this.ccfoliaLog.tabs=u,console.log(this.ccfoliaLog.tabs)},htmlSpecialChars(e){var t=document.createTextNode(e),s=document.createElement("p");return s.appendChild(t),s.innerHTML},tabNameMochi(e){return null!=e.attributes["tab-name"]?e.attributes["tab-name"].nodeValue:null==e.classList[0]?"メイン":"info"==e.classList[0]?"情報":"other"==e.classList[0]?"雑談":"secret"==e.classList[0]?e.classList[1]:void 0},diceTypeMochi(e){if(null==e.children[1])return null;const t=e.children[1].classList[1];return null==t?null:t},parseCssToObject(e){var t=[],s=e.match(/(.*){([^{}]+)}/g);return s&&s.forEach(e=>{const s=/(.*)\s*{([^}]*)}/,a=e.match(s);if(a){const e=a[1].trim(),s=a[2].trim();var n={};s.split(";").forEach((function(e){e=e.replace(/\r?\n? /g,"");var t=e.split(":");if(0!=t[0].length){var s=t[0].trim(),a=t[1].trim();n[s]=a}})),t.push({key:e,contents:n})}}),t},tabColors(e,t=null,s=null){if(null!=t&&null!=s)return{name:e,line_color:t,background_color:s};const a=this.ccfoliaLog.rows.filter(t=>!t.is_divider&&t.tab_name===e&&"#222222"!==t.color&&"#888888"!==t.color&&!t.name.match(/GM|KP|DL/));if(console.log(a),0===a.length)return{name:e,line_color:"#aaa",background_color:"#f7f7f7"};const n=a.reduce((e,t)=>e&&e.color!==t.color?e:t,null);return{name:e,line_color:n.color,background_color:this.convertToPaleColorSharp(n.color,.05)}},compositeColor(e,t){const s=parseInt(e,16)*t+255*(1-t);return Math.floor(s).toString(16)},convertToPaleColor(e,t){const s=[e.slice(0,2),e.slice(2,4),e.slice(4,6)];return s.map(e=>this.compositeColor(e,t)).join("")},convertToPaleColorSharp(e,t){const s=e.slice(1);return"#"+this.convertToPaleColor(s,t)},diceType(e){const{system:t}=this,s=/\n\s*[sS]/.test(e),a=!/.*${system.diceText} :.*＞.*/.test(e),n=e.match(/(.*)\((.*)\)(.*)＞ (.*)/);if(a){const a=new RegExp(`.*＞ (${t.diceTypes.map(e=>e.name).join("|")})`),i=e.match(a);if(i){const e=t.diceTypes.find(e=>e.name===i[1]);return{isOneline:!0,diceType:e,isSecret:s}}return n?{isOneline:!0,diceType:null,isSecret:s}:{isOneline:!0,diceType:null,isSecret:!1}}const i=new RegExp(`.*${t.diceText} :.*＞ (${t.diceTypes.map(e=>e.name).join("|")})`),o=e.match(i);if(o){const e=t.diceTypes.find(e=>e.name===o[1]);return{isOneLlne:!1,diceType:e,isSecret:s}}return n?{isOneline:!1,diceType:null,isSecret:s}:{isOneline:!1,diceType:null,isSecret:!1}},backgroundColor(e){return"メイン"==e?"#ffffff":"雑談"==e?"#f7f7f7":"情報"==e?"#fafafa":this.ccfoliaLog.tabs.find(t=>t.name==e).background_color},attract(e){if(this.attractFrom===e)return this.attractFrom=null,void(this.dogs=[]);if(null===this.attractFrom)return void(this.attractFrom=e);if(this.dogs.includes(e))return void(this.dogs=this.dogs.filter(t=>t!=e));if(this.ccfoliaLog.rows[this.attractFrom].tab_name!=this.ccfoliaLog.rows[e].tab_name)return void this.dogs.push(e);const t=this.ccfoliaLog.rows,s=t[this.attractFrom].tab_name,a=this.dogs;for(let n=this.attractFrom+1;n<=e;n++)(a.includes(n)||t[n].tab_name===s)&&(t.splice(this.attractFrom+1,0,t.splice(n,1)[0]),this.attractFrom++);this.attractFrom=null,this.dogs=[]},attractButtonType(e){return this.attractFrom==e?"info":this.dogs.includes(e)?"warning":null==this.attractFrom||e<this.attractFrom||this.ccfoliaLog.rows[e].tab_name!=this.ccfoliaLog.rows[this.attractFrom].tab_name?null:"primary"}},computed:{dividerRows:function(){return this.ccfoliaLog.rows.filter(e=>e.is_divider)},diceRows:function(){return this.ccfoliaLog.rows.filter(e=>e.dice_type&&e.dice_type.resultKey==this.selectedDiceResult&&this.selectedDiceTabs.includes(e.tab_name)&&this.selectedNameTabs.includes(e.name))}}},u=h,p=(s("0211"),s("2877")),f=Object(p["a"])(u,o,l,!1,null,null,null),b=f.exports,_={name:"App",components:{CcfoliaFormatter:b}},y=_,g=Object(p["a"])(y,n,i,!1,null,null,null),v=g.exports,k=s("5c96"),x=s.n(k),w=s("c3ff"),T=s.n(w),L=s("4897"),C=s.n(L);s("0fae"),s("e05f"),s("f9e3"),s("2dd8");C.a.use(T.a),a["default"].use(x.a),a["default"].config.productionTip=!0,new a["default"]({render:e=>e(v)}).$mount("#app")}});
//# sourceMappingURL=app.919f14aa.js.map